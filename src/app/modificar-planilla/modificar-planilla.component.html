<div class="container my-3">
	<h2>Modificar Planilla de Turnos</h2>
	<label class="ml-5">Semana:	{{planilla?.fecha_inicio | date}} -- {{planilla?.fecha_fin | date}}</label>
	<div align="center">
		<label>Día:</label>
		<select class="custom-select" [(ngModel)]="id_dia">
			<option *ngFor = "let dias of diasSemana; let i = index " value="{{i}}">{{dias}}</option>
		</select>
		<label>Turno:</label>
		<select class="custom-select" [(ngModel)]="id_turno">
			<option *ngFor = "let n of [0,1,2,3,4,5,6,7,8]" value="{{n}}">{{n+8}}:00</option>
		</select>
		<label>Actividad:</label>
		<select class="custom-select" [(ngModel)]="id_cargo">
			<option *ngFor = "let cargo of cargos; let i = index " value="{{i}}">{{cargo}}</option>
		</select>
		<label>Funcionario:</label>
		<select class="custom-select" [(ngModel)]="id_empleado">
			<ng-template ngFor let-key [ngForOf]="objectKeys(empleados)"; let-i = index>
			    <option *ngIf="empleados[key].cargo == cargos[id_cargo]" value={{i}}>{{empleados[key].nombre}}</option>
			</ng-template> 
		</select>
		<button class="btn btn-success" (click)="agregarTurno()">Agregar Turno</button>
	</div>
	<h1 id="tituloTablaHorario">Horarios</h1>
	<table class="table table-bordered table-responsive" id="tablaHorario">
		<tr>  
			<th>Horas</th>
			<th *ngFor = "let day of diasSemana">{{day}}</th>
		</tr>
		<tr *ngFor = "let n of [0,1,2,3,4,5,6,7,8]" id="trTablaHorario">
			<td> {{n+8}}:00 - {{n+9}}:00</td>
			<td (click)="detalleTurno(i,n,modal)" id="tdTablaHorario" *ngFor="let dia of planilla?.dias; let i = index ">
				<i *ngIf="dia?.turnos[n].empleados.length" [ngClass]="(dia?.turnos[n].empleados.length>1)?'fa fa-users':'fa fa-user'"></i>
			</td>
		</tr>
		<br>
	</table>
	<br>
	<div align="center">
		<button class="btn btn-success" (click)="modificarPlanilla()">Guardar planilla</button>
	</div>
</div>
<ng-template #modal let-c="close">
	<div class="modal-header">
		<h5 class="modal-title">{{diasSemana[diaSeleccionado]}} {{planilla.dias[diaSeleccionado].fecha | date}}</h5>
		<button class="close" (click)="c()">
        	<span>×</span>
        </button>
	</div>
	<div class="modal-body">
		<table class="table table-bordered table-responsive" id="tablaModal">
			<th>Funcionario</th>
			<th>Actividad</th>
			<th>Eliminar</th>
			<tr *ngFor="let key of planilla.dias[diaSeleccionado].turnos[turnoSeleccionado].empleados; let i=index ">
				<td>{{empleados[key].nombre}}</td>
				<td>{{empleados[key].cargo}}</td>
		    	<td>
		    		<button id="btnRedondo" (click) = "eliminarTurno(planilla.dias[diaSeleccionado].turnos[turnoSeleccionado],i)">
		    			<i class="fa fa-times"></i>
		    		</button>
		    	</td>
			</tr>
		</table>
	</div>
	<div class="modal-footer">
		<label>{{turnoSeleccionado+8}}:00 - {{turnoSeleccionado+9}}:00</label>
	</div>
</ng-template>

<ng-template #alertModal let-c="close">
	<div class="modal-header">
		<h5 class="modal-title">{{header}}</h5>
		<button class="close" (click)="c()">
        	<span>×</span>
        </button>
	</div>
	<div class="modal-body">
		{{msg}}
	</div>
	<div class="modal-footer">
		Botones(?)
	</div>
</ng-template>